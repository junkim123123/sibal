# ìŠˆí¼ ì–´ë“œë¯¼ í˜ì´ì§€ êµ¬í˜„ ì™„ë£Œ ë¬¸ì„œ

## ê°œìš”

ìŠˆí¼ ì–´ë“œë¯¼(God Mode) ì‹œìŠ¤í…œì´ ì™„ì„±ë˜ì—ˆìŠµë‹ˆë‹¤. NexSupplyë¥¼ ë‹¨ìˆœí•œ ì›¹ì‚¬ì´íŠ¸ì—ì„œ ìš´ì˜ ê°€ëŠ¥í•œ ì¡°ì§ìœ¼ë¡œ ì§„í™”ì‹œí‚¤ëŠ” í•µì‹¬ ê¸°ëŠ¥ì…ë‹ˆë‹¤.

## ì™„ë£Œëœ ì‘ì—…

### 1. Database Schema í™•ì¥ âœ…

**íŒŒì¼**: `web/supabase/super_admin_schema.sql`

**ë³€ê²½ ì‚¬í•­**:

#### profiles í…Œì´ë¸” í™•ì¥:
- `role` í•„ë“œ í™•ì¥: 'free', 'pro', 'manager', 'admin', 'super_admin' í—ˆìš©
- `workload_score`: ë§¤ë‹ˆì €ì˜ í˜„ì¬ í”„ë¡œì íŠ¸ ìˆ˜ (ìë™ ê³„ì‚°)
- `is_banned`: ìœ ì € ë°´ ì²˜ë¦¬
- `total_spend`: ì´ ì§€ì¶œì•¡ ì¶”ì 

#### projects í…Œì´ë¸” í™•ì¥:
- `dispatched_at`: ë§¤ë‹ˆì € ë°°ì • ì‹œê°„
- `payment_status`: 'pending', 'paid', 'failed', 'refunded'
- `payment_date`: ê²°ì œ ë‚ ì§œ

#### RLS ì •ì±… í™•ì¥:
- ìŠˆí¼ ì–´ë“œë¯¼ì€ ëª¨ë“  í”„ë¡œí•„ ì¡°íšŒ/ìˆ˜ì • ê°€ëŠ¥
- ìŠˆí¼ ì–´ë“œë¯¼ì€ ëª¨ë“  í”„ë¡œì íŠ¸ ì¡°íšŒ/ìˆ˜ì • ê°€ëŠ¥

#### ìë™ ì›Œí¬ë¡œë“œ ê³„ì‚°:
- íŠ¸ë¦¬ê±° í•¨ìˆ˜: í”„ë¡œì íŠ¸ ì—…ë°ì´íŠ¸ ì‹œ ë§¤ë‹ˆì € ì›Œí¬ë¡œë“œ ìë™ ê³„ì‚°

### 2. ë³´ì•ˆ ë¯¸ë“¤ì›¨ì–´ âœ…

**íŒŒì¼**: `web/middleware.ts`

**ê¸°ëŠ¥**:
- `/admin` ê²½ë¡œëŠ” `role='super_admin'`ì¸ ì‚¬ìš©ìë§Œ ì ‘ê·¼ ê°€ëŠ¥
- ê¶Œí•œì´ ì—†ìœ¼ë©´ ìë™ìœ¼ë¡œ `/dashboard`ë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸

### 3. ìŠˆí¼ ì–´ë“œë¯¼ ë ˆì´ì•„ì›ƒ âœ…

**íŒŒì¼**: `web/app/admin/layout.tsx`

**ê¸°ëŠ¥**:
- ë‹¤í¬ í†¤ ì‚¬ì´ë“œë°” ë„¤ë¹„ê²Œì´ì…˜
- ë°˜ì‘í˜• ë””ìì¸ (ëª¨ë°”ì¼ ë©”ë‰´)
- ìŠˆí¼ ì–´ë“œë¯¼ ê¶Œí•œ í™•ì¸
- ë¡œê·¸ì•„ì›ƒ ê¸°ëŠ¥

**ë„¤ë¹„ê²Œì´ì…˜**:
- Dashboard (Overview)
- Dispatch Center (ë§¤ë‹ˆì € í• ë‹¹)
- User Management (ìœ ì € ê´€ë¦¬)
- Revenue (ë§¤ì¶œ í˜„í™©)

### 4. Dashboard Overview âœ…

**íŒŒì¼**: `web/app/admin/page.tsx`

**KPI ì¹´ë“œ**:
- ğŸš¨ **Unassigned Pro Projects**: ë§¤ë‹ˆì € ë°°ì •ì´ í•„ìš”í•œ ëŒ€ê¸° ê±´ìˆ˜
- ğŸ“ˆ **Active Projects**: í˜„ì¬ ì§„í–‰ ì¤‘ì¸ ì´ í”„ë¡œì íŠ¸ ìˆ˜
- ğŸ’° **Total Revenue**: ì´ë²ˆ ë‹¬ ë§¤ì¶œ (Lemon Squeezy API ì—°ë™ ì¤€ë¹„)
- ğŸ‘¥ **Manager Utilization**: ê°€ìš© ë§¤ë‹ˆì € ìˆ˜ (ì˜ˆ: 3/5ëª…)

**Quick Actions**:
- Dispatch Projects
- Manage Users
- Revenue Dashboard

### 5. Dispatch Center (í•µì‹¬ ê¸°ëŠ¥) âœ…

**íŒŒì¼**: `web/app/admin/dispatch/page.tsx`

**ê¸°ëŠ¥**:
- **Split View**:
  - **Left**: Unassigned Projects (ê²°ì œ ì™„ë£Œ, ë§¤ë‹ˆì € ë¯¸ë°°ì •)
  - **Right**: Manager Pool (ë§¤ë‹ˆì € ë¦¬ìŠ¤íŠ¸ + ì›Œí¬ë¡œë“œ)
- í”„ë¡œì íŠ¸ ì„ íƒ â†’ ë§¤ë‹ˆì € ì„ íƒ â†’ Assign ë²„íŠ¼
- ë§¤ë‹ˆì € ì›Œí¬ë¡œë“œ í‘œì‹œ (í˜„ì¬ í”„ë¡œì íŠ¸ ìˆ˜)
- ë§¤ë‹ˆì € ì „ë¬¸ ë¶„ì•¼ íƒœê·¸ í‘œì‹œ

### 6. User Management âœ…

**íŒŒì¼**: `web/app/admin/users/page.tsx`

**ê¸°ëŠ¥**:
- ìœ ì € ëª©ë¡ í…Œì´ë¸” ë·°
- ê²€ìƒ‰ ê¸°ëŠ¥ (ì´ë©”ì¼, ì´ë¦„, íšŒì‚¬ëª…)
- **Ban/Unban** ê¸°ëŠ¥
- ì´ ì§€ì¶œì•¡ í‘œì‹œ
- ìœ ì € ìƒíƒœ í‘œì‹œ (Active/Banned)

**Stats Summary**:
- Total Users
- Banned Users
- Total Revenue

### 7. Revenue Dashboard âœ…

**íŒŒì¼**: `web/app/admin/revenue/page.tsx`

**ê¸°ëŠ¥**:
- Total Revenue (ì „ì²´ ë§¤ì¶œ)
- This Month Revenue (ì´ë²ˆ ë‹¬ ë§¤ì¶œ)
- Paid Projects (ê²°ì œ ì™„ë£Œ í”„ë¡œì íŠ¸)
- Refunded Projects (í™˜ë¶ˆëœ í”„ë¡œì íŠ¸)

**ì°¸ê³ **: í˜„ì¬ëŠ” í”„ë¡œì íŠ¸ ìˆ˜ Ã— $199ë¡œ ê³„ì‚°. í–¥í›„ Lemon Squeezy API ì—°ë™ í•„ìš”.

### 8. Server Actions âœ…

**íŒŒì¼**: `web/app/admin/actions.ts`

**í•¨ìˆ˜**:
- `assignManagerToProject()`: í”„ë¡œì íŠ¸ì— ë§¤ë‹ˆì € í• ë‹¹
- `banUser()`: ìœ ì € ë°´/ì–¸ë°´
- `updateManagerWorkload()`: ë§¤ë‹ˆì € ì›Œí¬ë¡œë“œ ì—…ë°ì´íŠ¸

## ì‚¬ìš© ë°©ë²•

### 1. ìŠˆí¼ ì–´ë“œë¯¼ ê³„ì • ìƒì„±

Supabase SQL Editorì—ì„œ ì‹¤í–‰:

```sql
-- ìŠˆí¼ ì–´ë“œë¯¼ ê¶Œí•œ ë¶€ì—¬
UPDATE profiles 
SET role = 'super_admin' 
WHERE email = 'your-super-admin@nexsupply.net';
```

### 2. ì ‘ì†

- URL: `/admin`
- ìŠˆí¼ ì–´ë“œë¯¼ ê³„ì •ìœ¼ë¡œ ë¡œê·¸ì¸ í›„ ìë™ ì ‘ê·¼ ê°€ëŠ¥

### 3. ë§¤ë‹ˆì € í• ë‹¹ (Dispatch Center)

1. `/admin/dispatch` ì ‘ì†
2. ì™¼ìª½ì—ì„œ ë°°ì •ì´ í•„ìš”í•œ í”„ë¡œì íŠ¸ ì„ íƒ
3. ì˜¤ë¥¸ìª½ì—ì„œ ì í•©í•œ ë§¤ë‹ˆì € ì„ íƒ
4. "Assign Manager" ë²„íŠ¼ í´ë¦­
5. ë§¤ë‹ˆì €ì˜ ëŒ€ì‹œë³´ë“œì— í”„ë¡œì íŠ¸ê°€ ìë™ìœ¼ë¡œ ë‚˜íƒ€ë‚¨

### 4. ìœ ì € ê´€ë¦¬

1. `/admin/users` ì ‘ì†
2. ìœ ì € ê²€ìƒ‰ (ì´ë©”ì¼, ì´ë¦„, íšŒì‚¬ëª…)
3. Ban/Unban ë²„íŠ¼ìœ¼ë¡œ ìœ ì € ì°¨ë‹¨/í•´ì œ
4. ì´ ì§€ì¶œì•¡ í™•ì¸

## ì›Œí¬í”Œë¡œìš° ì‹œë‚˜ë¦¬ì˜¤

1. **ê³ ê° ê²°ì œ**: ìœ ì € Aê°€ $199 ê²°ì œ â†’ `projects` í…Œì´ë¸” ìƒì„± (Status: paid, Manager: NULL)
2. **ì•Œë¦¼**: Super Adminì´ `/admin`ì—ì„œ "Unassigned Projects: 1" í™•ì¸
3. **íŒë‹¨**: Dispatch Centerì—ì„œ í”„ë¡œì íŠ¸ í™•ì¸ â†’ ì í•©í•œ ë§¤ë‹ˆì € ì„ íƒ
4. **ë°°ì •**: "Assign Manager" í´ë¦­
5. **ì‹¤í–‰**: ë§¤ë‹ˆì €ì˜ ëŒ€ì‹œë³´ë“œ(`/manager/workstation`)ì— í•´ë‹¹ í”„ë¡œì íŠ¸ê°€ ë‚˜íƒ€ë‚¨

## íŒŒì¼ êµ¬ì¡°

```
web/
â”œâ”€â”€ supabase/
â”‚   â””â”€â”€ super_admin_schema.sql          # DB ìŠ¤í‚¤ë§ˆ í™•ì¥
â”œâ”€â”€ app/
â”‚   â””â”€â”€ admin/
â”‚       â”œâ”€â”€ layout.tsx                   # ìŠˆí¼ ì–´ë“œë¯¼ ë ˆì´ì•„ì›ƒ
â”‚       â”œâ”€â”€ page.tsx                     # Dashboard Overview
â”‚       â”œâ”€â”€ actions.ts                   # ì„œë²„ ì•¡ì…˜
â”‚       â”œâ”€â”€ dispatch/
â”‚       â”‚   â””â”€â”€ page.tsx                 # Dispatch Center
â”‚       â”œâ”€â”€ users/
â”‚       â”‚   â””â”€â”€ page.tsx                 # User Management
â”‚       â””â”€â”€ revenue/
â”‚           â””â”€â”€ page.tsx                 # Revenue Dashboard
â””â”€â”€ middleware.ts                        # ê²½ë¡œ ë³´í˜¸ (ì—…ë°ì´íŠ¸)
```

## í–¥í›„ ê°œì„  ì‚¬í•­

1. **Lemon Squeezy API í†µí•©**:
   - ì‹¤ì œ ê²°ì œ ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
   - í™˜ë¶ˆ ì²˜ë¦¬ ìë™í™”
   - ë§¤ì¶œ ëŒ€ì‹œë³´ë“œ ì •í™•ë„ í–¥ìƒ

2. **ì•Œë¦¼ ì‹œìŠ¤í…œ**:
   - ìƒˆ ì£¼ë¬¸ ì‹œ Slack ì•Œë¦¼
   - ë§¤ë‹ˆì € ë°°ì • ì‹œ ì´ë©”ì¼ ì•Œë¦¼

3. **ìë™ ë°°ì • ë¡œì§**:
   - ë§¤ë‹ˆì € ì „ë¬¸ ë¶„ì•¼ ê¸°ë°˜ ìë™ ë°°ì •
   - ì›Œí¬ë¡œë“œ ê· í˜• ìë™ ê³„ì‚°

4. **ê³ ê¸‰ í•„í„°ë§**:
   - í”„ë¡œì íŠ¸ íƒ€ì…ë³„ í•„í„°
   - ë‚ ì§œ ë²”ìœ„ í•„í„°
   - ë§¤ë‹ˆì € ì„±ê³¼ ë¶„ì„

## ì™„ë£Œ

âœ… ìŠˆí¼ ì–´ë“œë¯¼ í˜ì´ì§€ êµ¬í˜„ ì™„ë£Œ
âœ… ë§¤ë‹ˆì € í• ë‹¹ (Dispatch) ê¸°ëŠ¥
âœ… ìœ ì € ê´€ë¦¬ (ë°´, ê²€ìƒ‰)
âœ… ë§¤ì¶œ í˜„í™©íŒ (ê¸°ë³¸ êµ¬ì¡°)
âœ… ë³´ì•ˆ ë¯¸ë“¤ì›¨ì–´
âœ… DB ìŠ¤í‚¤ë§ˆ í™•ì¥

ëª¨ë“  ì‘ì—…ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤! ğŸ‰

